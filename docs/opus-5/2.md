# ğŸ” Consolidated Review & Deep Analysis
## PowerPoint Agent Tools Project

---

## Executive Summary

I have completed a meticulous review of all three project documents. This analysis synthesizes the **WHAT**, **WHY**, and **HOW** of the PowerPoint Agent Tools ecosystemâ€”a sophisticated suite of 39 stateless CLI utilities designed for AI-driven presentation engineering.

---

## ğŸ“Š Document Coverage Matrix

| Document | Primary Focus | Key Contributions |
|----------|---------------|-------------------|
| **README/CONTRIBUTING.md** | Project overview, architecture, patterns | Hub-and-Spoke model, v3.1.0 features, critical gotchas |
| **AGENT_SYSTEM_PROMPT.md** | AI agent operating framework | Governance, 5-phase workflow, design intelligence, response protocols |
| **TOOL_DEVELOPMENT_HANDBOOK.md** | Developer implementation guide | Templates, API reference, resilience patterns, testing requirements |

---

## 1. THE WHAT: Project Identity & Scope

### 1.1 Core Mission

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  "Enabling AI agents to engineer presentations with precision,              â”‚
â”‚   safety, and visual intelligence"                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 What It Is

| Aspect | Description |
|--------|-------------|
| **Product** | Suite of 39 stateless CLI utilities for PowerPoint manipulation |
| **Target Users** | AI agents, automation engineers, human developers, accessibility specialists |
| **Core Dependency** | `python-pptx` library (with XML extensions for advanced features) |
| **Output Format** | `.pptx` files compatible with PowerPoint 2016+ and LibreOffice 7.0+ |

### 1.3 Tool Catalog (39 Tools by Domain)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           TOOL ECOSYSTEM                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CREATION (4)   â”‚  ppt_create_new, ppt_create_from_template,                â”‚
â”‚                 â”‚  ppt_create_from_structure, ppt_clone_presentation        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SLIDES (6)     â”‚  ppt_add_slide, ppt_delete_slide, ppt_duplicate_slide,    â”‚
â”‚                 â”‚  ppt_reorder_slides, ppt_set_slide_layout, ppt_set_footer â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CONTENT (6)    â”‚  ppt_set_title, ppt_add_text_box, ppt_add_bullet_list,    â”‚
â”‚                 â”‚  ppt_format_text, ppt_replace_text, ppt_add_notes         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  IMAGES (4)     â”‚  ppt_insert_image, ppt_replace_image, ppt_crop_image,     â”‚
â”‚                 â”‚  ppt_set_image_properties                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SHAPES (6)     â”‚  ppt_add_shape, ppt_format_shape, ppt_add_connector,      â”‚
â”‚                 â”‚  ppt_set_background, ppt_set_z_order, ppt_remove_shape    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DATA VIZ (4)   â”‚  ppt_add_chart, ppt_update_chart_data, ppt_format_chart,  â”‚
â”‚                 â”‚  ppt_add_table                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  INSPECTION (4) â”‚  ppt_get_info, ppt_get_slide_info, ppt_extract_notes,     â”‚
â”‚                 â”‚  ppt_capability_probe                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  VALIDATION (5) â”‚  ppt_validate_presentation, ppt_check_accessibility,      â”‚
â”‚                 â”‚  ppt_export_images, ppt_export_pdf, + 1 more              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 Version 3.1.0 Key Features

| Feature | Description | Impact |
|---------|-------------|--------|
| **Opacity Support** | `fill_opacity` and `line_opacity` parameters (0.0-1.0) | Enables semi-transparent overlays for text readability |
| **Z-Order Control** | `ppt_set_z_order` with direct XML manipulation | Enables shape layering control |
| **Speaker Notes** | `ppt_add_notes` with append/prepend/overwrite modes | Enables presentation scripting |
| **Enhanced Replace** | `ppt_replace_text` v2.0 with slide/shape targeting | Surgical text replacement |
| **Deprecation** | `transparency` parameter â†’ use `fill_opacity` | Consistency (opacity = 1 - transparency) |

---

## 2. THE WHY: Design Philosophy & Rationale

### 2.1 The Five Design Pillars

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DESIGN PILLARS                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  STATELESS   â”‚    ATOMIC    â”‚  COMPOSABLE  â”‚  ACCESSIBLE  â”‚  VISUAL-AWARE   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Each call    â”‚ Openâ†’Modify  â”‚ Tools chain  â”‚ WCAG 2.1     â”‚ Typography      â”‚
â”‚ independent  â”‚ â†’Saveâ†’Close  â”‚ via pipes    â”‚ compliance   â”‚ Color theory    â”‚
â”‚              â”‚              â”‚              â”‚              â”‚ Content density â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ WHY:         â”‚ WHY:         â”‚ WHY:         â”‚ WHY:         â”‚ WHY:            â”‚
â”‚ AI agents    â”‚ Predictable  â”‚ Pipeline     â”‚ Inclusive    â”‚ Professional    â”‚
â”‚ lose context â”‚ recovery     â”‚ automation   â”‚ outputs      â”‚ quality         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Why Statelessness?

| Challenge | Without Statelessness | With Statelessness |
|-----------|----------------------|-------------------|
| AI context loss | Operations fail silently | Each call self-contained |
| Parallel execution | Race conditions | Independent operations |
| Error recovery | Complex state restoration | Simply retry the command |
| Pipeline composition | Tight coupling | Loose coupling via JSON |
| Debugging | State inspection required | Deterministic reproduction |

### 2.3 Why Hub-and-Spoke Architecture?

```
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   AI Agent / Human      â”‚
                         â”‚   (Orchestration)       â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                      â”‚                      â”‚
              â–¼                      â–¼                      â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  CLI Tool A    â”‚    â”‚  CLI Tool B    â”‚    â”‚  CLI Tool C    â”‚
     â”‚  (SPOKE)       â”‚    â”‚  (SPOKE)       â”‚    â”‚  (SPOKE)       â”‚
     â”‚  Thin wrapper  â”‚    â”‚  Thin wrapper  â”‚    â”‚  Thin wrapper  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                     â”‚                      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   PowerPointAgent Core (HUB)    â”‚
                   â”‚                                 â”‚
                   â”‚   â€¢ Single source of truth      â”‚
                   â”‚   â€¢ All XML manipulation        â”‚
                   â”‚   â€¢ File locking & safety       â”‚
                   â”‚   â€¢ Position/Size resolution    â”‚
                   â”‚   â€¢ Version computation         â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚         python-pptx             â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Rationale:**
- **Centralized Logic**: All complex operations in one place (core)
- **Thin Tools**: CLI tools are simple wrappers, easy to maintain
- **Consistency**: All tools behave identically (same error handling, JSON output)
- **Extensibility**: Add new tools without modifying core

### 2.4 Why JSON-First I/O?

| Requirement | JSON Solution |
|-------------|---------------|
| Machine parsing | Structured, typed data |
| Error handling | `error_type` field for programmatic handling |
| Pipeline chaining | Output feeds next tool's input |
| Audit trails | Easy to log and store |
| Version tracking | `presentation_version` in every response |

---

## 3. THE HOW: Implementation Architecture

### 3.1 The Governance Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GOVERNANCE HIERARCHY                                 â”‚
â”‚                        (In Order of Precedence)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. ğŸ”’ Never perform destructive operations without approval                 â”‚
â”‚  2. ğŸ”’ Always work on cloned copies, never source files                      â”‚
â”‚  3. ğŸ”’ Validate before delivery, always                                      â”‚
â”‚  4. ğŸ”’ Fail safelyâ€”incomplete is better than corrupted                       â”‚
â”‚  5. ğŸ”’ Document everything for audit and rollback                            â”‚
â”‚  6. ğŸ”’ Refresh indices after structural changes                              â”‚
â”‚  7. ğŸ”’ Dry-run before actual execution for replacements                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 The 5-Phase Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DISCOVER   â”‚â”€â”€â”€â–¶â”‚     PLAN     â”‚â”€â”€â”€â–¶â”‚    CREATE    â”‚â”€â”€â”€â–¶â”‚   VALIDATE   â”‚â”€â”€â”€â–¶â”‚   DELIVER    â”‚
â”‚              â”‚    â”‚              â”‚    â”‚              â”‚    â”‚              â”‚    â”‚              â”‚
â”‚ â€¢ Probe      â”‚    â”‚ â€¢ Manifest   â”‚    â”‚ â€¢ Execute    â”‚    â”‚ â€¢ Structural â”‚    â”‚ â€¢ Package    â”‚
â”‚ â€¢ Inspect    â”‚    â”‚ â€¢ Design     â”‚    â”‚ â€¢ Track      â”‚    â”‚ â€¢ A11y       â”‚    â”‚ â€¢ Document   â”‚
â”‚ â€¢ Extract    â”‚    â”‚ â€¢ Rationale  â”‚    â”‚ â€¢ Version    â”‚    â”‚ â€¢ Design     â”‚    â”‚ â€¢ Rollback   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚                   â”‚                   â”‚
       â–¼                   â–¼                   â–¼                   â–¼                   â–¼
  ppt_capability     Change Manifest      ppt_add_*         ppt_validate_*      ppt_export_*
  ppt_get_info       (JSON Schema)        ppt_format_*      ppt_check_a11y      Manifest
  ppt_get_slide      Design Decisions     ppt_replace_*                          Report
```

### 3.3 Critical Patterns (The "Gotchas")

#### Pattern 1: Shape Index Invalidation

```
âš ï¸ CRITICAL: Shape indices shift after structural operations!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OPERATIONS THAT INVALIDATE INDICES                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  add_shape()     â†’ Adds new index at end                                     â”‚
â”‚  remove_shape()  â†’ Shifts subsequent indices DOWN                            â”‚
â”‚  set_z_order()   â†’ REORDERS all indices                                      â”‚
â”‚  delete_slide()  â†’ Invalidates ALL indices on slide                          â”‚
â”‚  add_slide()     â†’ Invalidates slide indices                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MANDATORY PROTOCOL:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  After ANY index-invalidating operation:                                     â”‚
â”‚                                                                              â”‚
â”‚  1. IMMEDIATELY call ppt_get_slide_info.py                                   â”‚
â”‚  2. Use REFRESHED indices for subsequent operations                          â”‚
â”‚  3. NEVER cache indices across operations                                    â”‚
â”‚  4. Use shape NAMES when available, not just indices                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Pattern 2: The Probe-First Pattern

```python
# âŒ WRONG - Guessing layout names
agent.add_slide(layout_name="Title and Content")  # Might not exist!

# âœ… CORRECT - Probe first, then use discovered values
probe_result = agent.get_capabilities(deep=True)
available_layouts = probe_result["layouts"]
agent.add_slide(layout_name=available_layouts[1])  # Use actual layout
```

#### Pattern 3: The Overlay Pattern (v3.1.0)

```python
# Complete workflow for semi-transparent overlays

# Step 1: Add overlay shape with opacity
result = agent.add_shape(
    slide_index=0,
    shape_type="rectangle",
    position={"left": "0%", "top": "0%"},
    size={"width": "100%", "height": "100%"},
    fill_color="#FFFFFF",
    fill_opacity=0.15  # 15% opaque - subtle, non-competing
)
overlay_index = result["shape_index"]

# Step 2: IMMEDIATELY refresh indices
slide_info = agent.get_slide_info(slide_index=0)

# Step 3: Send overlay to back
agent.set_z_order(slide_index=0, shape_index=overlay_index, action="send_to_back")

# Step 4: IMMEDIATELY refresh indices AGAIN
slide_info = agent.get_slide_info(slide_index=0)
```

#### Pattern 4: Opacity vs Transparency

```
OPACITY (Modern - USE THIS):          TRANSPARENCY (Deprecated):
0.0 â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º 1.0       1.0 â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º 0.0
Invisible            Fully visible   Invisible            Fully visible

CONVERSION: opacity = 1.0 - transparency

âš ï¸ The `transparency` parameter is DEPRECATED and will be removed in v4.0
```

### 3.4 The Resilience Framework (Discovery Tools)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PROBE RESILIENCE PATTERN                                  â”‚
â”‚                    (3 Mandatory Layers)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  LAYER 1: TIMEOUT DETECTION                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ Check elapsed time at EACH iteration                              â”‚    â”‚
â”‚  â”‚  â€¢ Default timeout: 15 seconds                                       â”‚    â”‚
â”‚  â”‚  â€¢ On timeout: STOP gracefully, return partial results               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â–¼                                               â”‚
â”‚  LAYER 2: TRANSIENT SLIDES                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ Add slide temporarily for ACCURATE position measurement           â”‚    â”‚
â”‚  â”‚  â€¢ Use generator pattern with finally block for cleanup              â”‚    â”‚
â”‚  â”‚  â€¢ No save() = no file mutation = atomic read                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â–¼                                               â”‚
â”‚  LAYER 3: GRACEFUL DEGRADATION                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ Cap analysis scope (max 50 layouts)                               â”‚    â”‚
â”‚  â”‚  â€¢ Return partial_results: true flag                                 â”‚    â”‚
â”‚  â”‚  â€¢ Include warnings[] array                                          â”‚    â”‚
â”‚  â”‚  â€¢ Always return valid JSON, never crash                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5 Error Handling Matrix

| Exit Code | Category | Meaning | Retryable | Action |
|-----------|----------|---------|-----------|--------|
| **0** | Success | Operation completed | N/A | Proceed |
| **1** | Usage Error | Invalid arguments, file not found | No | Fix arguments |
| **2** | Validation Error | Schema/content invalid | No | Fix input |
| **3** | Transient Error | Timeout, I/O, network | **Yes** | Retry with backoff |
| **4** | Permission Error | Approval token missing/invalid | No | Obtain token |
| **5** | Internal Error | Unexpected failure | Maybe | Investigate |

### 3.6 The Approval Token System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APPROVAL TOKEN SYSTEM                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  PROTECTED OPERATIONS:                                                       â”‚
â”‚  â€¢ ppt_delete_slide      (slide deletion)                                    â”‚
â”‚  â€¢ ppt_remove_shape      (shape removal)                                     â”‚
â”‚  â€¢ Mass text replacement (without dry-run)                                   â”‚
â”‚  â€¢ Background changes    (on all slides)                                     â”‚
â”‚  â€¢ Any operation with    critical: true in manifest                          â”‚
â”‚                                                                              â”‚
â”‚  TOKEN STRUCTURE:                                                            â”‚
â”‚  {                                                                           â”‚
â”‚    "token_id": "apt-YYYYMMDD-NNN",                                          â”‚
â”‚    "manifest_id": "manifest-xxx",                                            â”‚
â”‚    "scope": ["delete:slide", "replace:all", "remove:shape"],                â”‚
â”‚    "expiry": "ISO8601",                                                      â”‚
â”‚    "single_use": true,                                                       â”‚
â”‚    "signature": "HMAC-SHA256:base64.signature"                              â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â”‚  ENFORCEMENT:                                                                â”‚
â”‚  IF destructive operation requested WITHOUT valid token:                     â”‚
â”‚    â†’ REFUSE operation                                                        â”‚
â”‚    â†’ Return error with suggestion to obtain token                            â”‚
â”‚    â†’ Log refusal in audit trail                                              â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.7 Presentation Version Tracking

```python
# Version tracking is MANDATORY for all mutation operations

# Version Format: SHA-256 hex string (first 16 characters)
# Version Computation: hash(file_path + slide_count + slide_IDs + shape_geometry + timestamp)

# Example response with version tracking:
{
    "status": "success",
    "file": "/work/presentation.pptx",
    "presentation_version_before": "a1b2c3d4e5f6g7h8",
    "presentation_version_after": "i9j0k1l2m3n4o5p6",
    "changes_made": { ... }
}

# Version Mismatch Detection:
# If expected version != actual version:
#   â†’ ABORT operation
#   â†’ Re-probe presentation
#   â†’ Update manifest
#   â†’ Seek guidance
```

---

## 4. Design Intelligence System

### 4.1 Visual Hierarchy Framework

```
                    â–² PRIMARY (Title, Key Message)
                   â•± â•²  Largest, Boldest, Top Position
                  â•±   â•²  Font: 36-60pt
                 â•±â”€â”€â”€â”€â”€â•²
                â•±       â•² SECONDARY (Subtitles, Headers)
               â•±         â•² Medium Size, Supporting
              â•±           â•² Font: 20-28pt
             â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²
            â•±               â•² TERTIARY (Body, Details)
           â•±                 â•² Smallest, Dense Info
          â•±                   â•² Font: 14-20pt
         â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²
        â•±                       â•² AMBIENT (Backgrounds, Overlays)
       â•±___________________________â•² Subtle, Non-Competing
                                    Opacity: 0.15
```

### 4.2 Typography Scale

| Element | Minimum | Recommended | Maximum |
|---------|---------|-------------|---------|
| Main Title | 36pt | 44pt | 60pt |
| Slide Title | 28pt | 32pt | 40pt |
| Body Text | 16pt | 18pt | 24pt |
| Captions | 12pt | 14pt | 16pt |
| **NEVER BELOW** | **10pt** | - | - |

### 4.3 Content Density Rules (6Ã—6 Rule)

```
STANDARD (Default):
â”œâ”€â”€ Maximum 6 bullet points per slide
â”œâ”€â”€ Maximum 6 words per bullet point
â””â”€â”€ One key message per slide

EXTENDED (Requires explicit approval):
â”œâ”€â”€ Data-dense slides: Up to 8 bullets, 10 words
â”œâ”€â”€ Must document exception in manifest design_decisions
```

### 4.4 Accessibility Requirements (WCAG 2.1)

| Check | Requirement | Remediation Tool |
|-------|-------------|------------------|
| Alt text | All images | `ppt_set_image_properties --alt-text` |
| Contrast | â‰¥4.5:1 (body), â‰¥3:1 (large) | `ppt_format_text --color` |
| Font size | â‰¥10pt, prefer â‰¥12pt | `ppt_format_text --font-size` |
| Reading order | Logical tab order | Manual reordering |
| Color independence | Info not by color alone | Add patterns/labels |

---

## 5. Quality Assurance Checklist

### 5.1 Pre-Delivery Gate

```markdown
### Governance & Safety
- [ ] Clone-before-edit enforced
- [ ] Approval tokens validated for destructive ops
- [ ] Presentation versions tracked (before/after)
- [ ] Shape indices refreshed after structural changes
- [ ] Audit trail complete

### Technical Requirements
- [ ] JSON output to stdout only
- [ ] Exit codes per matrix (0-5)
- [ ] File existence validated
- [ ] Slide/shape bounds checked
- [ ] Standard error format with error_type

### v3.1.0+ Features
- [ ] fill_opacity used (not deprecated transparency)
- [ ] Indices refreshed after z-order changes
- [ ] Speaker notes support all modes

### Accessibility
- [ ] All images have alt text
- [ ] Color contrast â‰¥ 4.5:1
- [ ] No text below 10pt
- [ ] Complex visuals have text alternatives in notes

### Design
- [ ] Typography hierarchy consistent
- [ ] Color palette â‰¤ 5 colors
- [ ] Font families â‰¤ 3
- [ ] Content density within 6Ã—6 rule
```

---

## 6. Key Insights & Recommendations

### 6.1 Architectural Strengths

| Strength | Evidence | Benefit |
|----------|----------|---------|
| **Separation of Concerns** | Hub-and-Spoke architecture | Easy maintenance, single source of truth |
| **Safety by Design** | Clone-before-edit, approval tokens | Zero risk to source files |
| **Resilience** | Timeout handling, graceful degradation | Production-ready for large files |
| **Extensibility** | Thin CLI wrappers, core methods | Add tools without core changes |
| **Observability** | Version tracking, audit trails | Full operational visibility |

### 6.2 Critical Success Factors for Development

1. **Always Apply Hygiene Block** - Redirect stderr to prevent JSON corruption
2. **Never Skip Index Refresh** - Shape indices are volatile after structural changes
3. **Always Clone First** - Never operate on source files
4. **Always Probe First** - Never guess layout names or template structure
5. **Always Track Versions** - Every mutation must capture before/after versions

### 6.3 Common Pitfalls to Avoid

| Pitfall | Consequence | Prevention |
|---------|-------------|------------|
| Print statements to stdout | Invalid JSON, broken pipelines | Use Hygiene Block |
| Cached shape indices | Operations on wrong shapes | Refresh after every structural change |
| Guessing layout names | LayoutNotFoundError | Probe template first |
| Editing source files | Data loss risk | Clone-before-edit |
| Skipping version tracking | Race conditions undetected | Always capture before/after |

---

## 7. Ready State Confirmation

I now have deep understanding of:

| Dimension | Understanding Level |
|-----------|---------------------|
| **Architecture** | Hub-and-Spoke model, 39 CLI tools, PowerPointAgent core |
| **Design Philosophy** | 5 Pillars, Statelessness, Atomic operations |
| **Governance** | Safety hierarchy, Approval tokens, Version tracking |
| **Workflow** | 5-Phase (Discoverâ†’Planâ†’Createâ†’Validateâ†’Deliver) |
| **Critical Patterns** | Index management, Probe-first, Overlay pattern |
| **Error Handling** | Exit code matrix, JSON error format |
| **Resilience** | Timeout handling, Transient slides, Graceful degradation |
| **Design Intelligence** | Typography, Color theory, Accessibility |
| **Quality Gates** | Pre-delivery checklist, Testing requirements |

---

## ğŸ¯ Ready for Tasks

I am now fully prepared to:

1. **Create new CLI tools** following the Master Template with governance sections
2. **Modify existing tools** while maintaining architectural consistency
3. **Debug issues** using the Troubleshooting Playbook
4. **Implement features** with proper opacity, z-order, and version tracking
5. **Ensure compliance** with accessibility and design intelligence requirements
6. **Apply the 5-phase workflow** for any presentation engineering task

**What would you like to build or modify?**
