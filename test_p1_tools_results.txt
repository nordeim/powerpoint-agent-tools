$ python3 test_p1_tools.py -v
=================================================== test session starts ====================================================
platform linux -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- /opt/venv/bin/python3
cachedir: .pytest_cache
PySide6 6.9.2 -- Qt runtime 6.9.2 -- Qt compiled 6.9.2
rootdir: /home/project/powerpoint-agent-tools
plugins: qt-4.5.0, cov-6.3.0, Faker-37.6.0, mock-3.15.0, asyncio-1.1.0, anyio-4.10.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 18 items                                                                                                         

test_p1_tools.py::TestP1Tools::test_add_bullet_list_simple PASSED                                                    [  5%]
test_p1_tools.py::TestP1Tools::test_add_numbered_list PASSED                                                         [ 11%]
test_p1_tools.py::TestP1Tools::test_add_bullet_list_with_formatting PASSED                                           [ 16%]
test_p1_tools.py::TestP1Tools::test_add_bullet_list_grid_position PASSED                                             [ 22%]
test_p1_tools.py::TestP1Tools::test_add_chart_column PASSED                                                          [ 27%]
test_p1_tools.py::TestP1Tools::test_add_chart_pie PASSED                                                             [ 33%]
test_p1_tools.py::TestP1Tools::test_add_chart_line_with_title PASSED                                                 [ 38%]
test_p1_tools.py::TestP1Tools::test_add_shape_rectangle PASSED                                                       [ 44%]
test_p1_tools.py::TestP1Tools::test_add_shape_ellipse_styled PASSED                                                  [ 50%]
test_p1_tools.py::TestP1Tools::test_add_shape_arrow PASSED                                                           [ 55%]
test_p1_tools.py::TestP1Tools::test_add_table_with_headers PASSED                                                    [ 61%]
test_p1_tools.py::TestP1Tools::test_add_table_with_data PASSED                                                       [ 66%]
test_p1_tools.py::TestP1Tools::test_add_table_empty PASSED                                                           [ 72%]
test_p1_tools.py::TestP1Tools::test_replace_text_simple FAILED                                                       [ 77%]
test_p1_tools.py::TestP1Tools::test_replace_text_case_sensitive PASSED                                               [ 83%]
test_p1_tools.py::TestP1Tools::test_replace_text_dry_run FAILED                                                      [ 88%]
test_p1_tools.py::TestP1Tools::test_workflow_business_report PASSED                                                  [ 94%]
test_p1_tools.py::TestP1Tools::test_workflow_data_presentation PASSED                                                [100%]

========================================================= FAILURES =========================================================
___________________________________________ TestP1Tools.test_replace_text_simple ___________________________________________

self = <test_p1_tools.TestP1Tools object at 0x7504ef111010>
tools_dir = PosixPath('/home/project/powerpoint-agent-tools/tools'), temp_dir = PosixPath('/tmp/tmp_w4_l24j')

    def test_replace_text_simple(self, tools_dir, temp_dir):
        """Test simple text replacement."""
        filepath = temp_dir / 'replace_test.pptx'
        self.create_test_presentation(filepath, tools_dir)
    
        # Add text to replace
        self.run_tool('ppt_set_title.py', {
            'file': filepath,
            'slide': 0,
            'title': 'Presentation 2023',
            'subtitle': 'Annual Review 2023'
        }, tools_dir)
    
        result = self.run_tool('ppt_replace_text.py', {
            'file': filepath,
            'find': '2023',
            'replace': '2024'
        }, tools_dir)
    
        assert result['returncode'] == 0, (
            f"\n{'='*60}\n"
            f"Tool execution failed!\n"
            f"{'='*60}\n"
            f"Tool: ppt_replace_text.py\n"
            f"Return Code: {result['returncode']}\n"
            f"\n--- STDERR ---\n{result['stderr']}\n"
            f"\n--- STDOUT ---\n{result.get('stdout', result.get('data', ''))}\n"
            f"{'='*60}"
        )
        assert result['data']['status'] == 'success'
>       assert result['data']['replacements_made'] >= 2
E       assert 0 >= 2

test_p1_tools.py:547: AssertionError
__________________________________________ TestP1Tools.test_replace_text_dry_run ___________________________________________

self = <test_p1_tools.TestP1Tools object at 0x7504ef110a10>
tools_dir = PosixPath('/home/project/powerpoint-agent-tools/tools'), temp_dir = PosixPath('/tmp/tmpxsbprd46')

    def test_replace_text_dry_run(self, tools_dir, temp_dir):
        """Test dry run mode (preview without changes)."""
        filepath = temp_dir / 'dry_run_test.pptx'
        self.create_test_presentation(filepath, tools_dir)
    
        # Add text
        self.run_tool('ppt_set_title.py', {
            'file': filepath,
            'slide': 0,
            'title': 'Test Presentation'
        }, tools_dir)
    
        result = self.run_tool('ppt_replace_text.py', {
            'file': filepath,
            'find': 'Test',
            'replace': 'Demo',
            'dry-run': True
        }, tools_dir)
    
        assert result['returncode'] == 0, (
            f"\n{'='*60}\n"
            f"Tool execution failed!\n"
            f"{'='*60}\n"
            f"Tool: ppt_replace_text.py\n"
            f"Return Code: {result['returncode']}\n"
            f"\n--- STDERR ---\n{result['stderr']}\n"
            f"\n--- STDOUT ---\n{result.get('stdout', result.get('data', ''))}\n"
            f"{'='*60}"
        )
        assert result['data']['status'] == 'dry_run'
>       assert result['data']['matches_found'] >= 1
E       assert 0 >= 1

test_p1_tools.py:612: AssertionError
================================================= short test summary info ==================================================
FAILED test_p1_tools.py::TestP1Tools::test_replace_text_simple - assert 0 >= 2
FAILED test_p1_tools.py::TestP1Tools::test_replace_text_dry_run - assert 0 >= 1
============================================== 2 failed, 16 passed in 32.71s ========
